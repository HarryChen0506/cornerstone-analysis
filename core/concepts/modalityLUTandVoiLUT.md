# Modality LUT and VOI LUT

> Cornerstone supports both Value of Interest (VOI) and Modality Lookup Tables

在医学图像的处理过程中医生经常需要频繁地变换窗宽、窗位来对感兴趣的病灶部位进行细致的研究.

> 医学影像显示过程分析是美国放射学会和美国电器制造商协会组织指定的用于医学图像存储和传输的标准。目前几乎大部分的医学设备产生的医学图像都是采用这种格式。作为一种特殊的图像编码格式，通用图像浏览软件并不能直接显示，要显示DICOM格式的医学图像必须将原始图像数据经过一系列的转换才能得到可直接在显示设备上显示的数据(称之为P—Values)。DICOM医学图像显示转换过程如图1所示，需要经过Modality LUT、VOI LUT、Presentation LUT三个转换过程，最终输出的P Values才是可以直接显示的图像数据。
> Modality LUT转换(数据规范化转换通常不同生产厂商的设备很难保证在一种设备上生成的图像和其他生产厂商的同类型设备上生成的图像在度量上是一致的，为此就需要将不同设备厂家产生的图像的原始数据转换到一个标准的度量空间，转换就是完成这个功能的。医疗设备的生产厂商都会在自己的图像中采用DICOM标准规定的格式说明如何将自己的数据转换为标准图像数据，中规定可以使用通过查找表(Look Up Table，简称LUn查找和通过斜率／截距(RescaIe／转换两种方法中的一种。

> VOl (Value Of Interest) LUT转换(感兴趣区转换由于医学图像数据动态范围大(像素深度通常不低于4096个灰度级)，因此一般显示器很难提供如此高的动态范围一次显示整幅图像的全部信息细节，在图像的处理中一般都是先选择一个操作者感兴趣的区域，然后将该区域的图像信息映射到显示器能显示的整个数据范围，这样就增加了该区域的图像信息的对比度。这个过程DICOM标准中称之为感兴趣区简称VOI) LUT (Look Up Table)转换。临床医生感兴趣的窗宽、窗位调节功能就是VOI LUT转换的一种算法实现。VOI LUT转换可以使用设置窗宽、窗位的线性转换算法和通过查找查找表(LUT)转换的非线性算法两种算法中的一种且只能使用其中的一种，具体使用哪种算法在DICOM文件中有专门的标记来设置。

> 窗宽、窗位线性转换算法是根据预知的窗宽和窗位值获得需要显示的窗口大小(窗宽)和中心位置(窗位)，从而将窗口区域的图像数据线性地转换到显示器的最大范围内，高于或低于窗口上、下限的图像数据则分别设置为最高或最暗的显示值。用公式表示为：其中V：图像数据，G：显示器显示值，gm：显示器的最大显示值，W：窗宽，C：窗位。在这里窗宽是指需要显示图像的范围，调节窗宽主要影响对比度，窗宽越大图像灰度层次多，组织对比度减少，细节显示差，而窗位也称窗中心，表示显示区域的中心位置，例如骨骼的窗位(C)、窗宽(W)分别为C=400，，那么就可以利用调窗处理将窗宽调节到骨骼窗宽，窗位调节到骨骼的窗位，然后利用上面的公式将图像V换算成显示器显示值，最终得到的结果是只显示窗口范围内的图像，也就是骨骼。
